# Rendering Python Policies with render_agent.py

This README explains how to use the `render_agent.py` script to visualize and interact with Python policies generated by the `tree2code` tool. The `--pythonfile` option allows you to render and evaluate the execution of Python decision tree implementations in real-time.

## Overview

This document focuses specifically on the `--pythonfile` option, which allows you to visualize and debug Python policies generated from decision trees.

## Using the --pythonfile Option

### Basic Usage

To render a Python policy file, use the following command:

```bash
python render_agent.py --pythonfile(exact file, not directory) --exp_name <experiment_name>
```

This will load and visualize the Python policy file located in `resources/program_policies/<experiment_name>-extraction/`.

### Full Command Format

```bash
python render_agent.py --pythonfile [--path <path_to_pythonfile>] --exp_name <experiment_name> [options]
```

### Example

   ```bash
   python render_agent.py -g Pong -r human -s 0 -p default --python_file /path/to/custom/play_python_64_leaves.py 
   ```

## Enabling Code Execution Visualization

To enable real-time visualization of the code execution flow, uncomment line 12 in `render_agent.py`:

```python
# Change this:
from utils.python_play_wrapper import PythonFunctionWrapper
#from utils.python_play_wrapper_trace import PythonFunctionWrapperTrace as PythonFunctionWrapper

# To this:
#from utils.python_play_wrapper import PythonFunctionWrapper
from utils.python_play_wrapper_trace import PythonFunctionWrapperTrace as PythonFunctionWrapper
```

After making this change, run the `render_agent.py` script with the `--pythonfile` option. This will enable a tracing mode that shows which branches of the decision tree are being executed in real-time, providing insights into the decision-making process of the policy.

## How It Works

When using the `--pythonfile` option, the script:

1. Locates the Python policy file based on the provided experiment name or path
2. Loads the focus file and feature descriptions from the original checkpoint
3. Creates a `PythonFunctionWrapper` (or `PythonFunctionWrapperTrace` if code visualization is enabled) around the Python file
4. Sets up the environment based on the experiment settings
5. Initializes the renderer and runs the visualization loop

The wrapper handles the interface between the environment and the Python code, ensuring that the appropriate feature vector is passed to the `play()` function and the resulting action is applied to the environment.

## Visualization Features

- **Standard Mode**: Shows the environment and the actions taken by the Python policy
- **Trace Mode**: (When enabled) Shows the decision path through the if-else tree structure in real-time

## Notes

1. The Python policy file must have a `play(state)` function that takes a state vector and returns an action.
2. Make sure the Python policy was generated using the same focus file as specified in the render command.